#!/usr/bin/python
'''
Date : 1402/01/04
Author : AmirhosseinKhanshabani - @AmirZoyber

1. run Wireshark .
2. turn your netCard to monitor mode.
3. capture that
4. search for a 802.11 Protocol // Beacon Info on packets and click on that.
5. on tagged parameter you can see the SSID

usage : python3 SSIDfinder.py wlan0 1000

'''

import sys
from scapy.all import *

ssids = set()

def packetHandler(pkt):
    if (pkt.haslayer(Dot11Beacon)):
        if (pkt.info not in ssids):

            print(len(ssids),pkt.addr3,pkt.info)
            ssids.add(pkt.info)


# v2
def packetHandler(pkt):
    if (pkt.haslayer(Dot11Beacon)):
        tmp = pkt
        while (tmp):
            tmp = tmp.getlayer(Dot11Elt)
            if (tmp and tmp.ID==0 and (tmp.info not in ssids)):
                ssids.add(tmp.info)
                print(len(ssids), pkt.addr3, tmp, tmp.info)
                break
            tmp = tmp.payload

sniff(iface=sys.argv[1], count=int(sys.argv[2]), prn = PacketHandler)


'''
 an example of output:

'''
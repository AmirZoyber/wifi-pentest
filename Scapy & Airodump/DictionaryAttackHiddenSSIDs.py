#!/usr/bin/python
'''
Date : 1402/01/12
Author : AmirhosseinKhanshabani - @AmirZoyber

this script will find hidden SSIDs wireless network around you with dictionary attack.
-what if no client is around?
why not use a dictionary of common SSIDs and send Probe Request packets to each of them?
AP will respond if the SSID is in the dictionary.

the file ssidlist contains a list of common SSIDs.

'''

# airodump-ng mon0 -c 8

# the comment up is for airodump-ng to find the channel of the network
# output is like :
# CH  8 ][ Elapsed: 1 min ][ 2014-02-12 23:00 ][ WPA handshake: 0 ][ WPS handshake: 0
# BSSID              PWR  Beacons    #Data, #/s  CH  MB   ENC  CIPHER AUTH ESSID
# 00:1B:77:0A:1B:2C  -58       100        0    0   8  54e. WPA2 CCMP   PSK  <length:  0>
# 00:1B:77:0A:1B:2C  -58       100        0    0   8  54e. WPA2 CCMP   PSK  <length:  0>
# 00:1B:77:0A:1B:2C  -58       100        0    0   8  54e. WPA2 CCMP   PSK  <length:  0>
# .
# .
# .

import sys
from scapy.all import *

myMac = "00:1B:77:0A:1B:2C"
brdMac = "FF:FF:FF:FF:FF:FF"

# run
# python3 DictionaryAttackHiddenSSIDs.py ssidlist mon0

for ssid in open(sys.argv[1],'r').readlines():
    pkt = RadioTap() / Dot11(type=0,subtype=4,addr1=brdMac,addr2=myMac,addr3=brdMac) / Dot11ProbeReq() / Dot11Elt(ID="SSID",info=ssid.strip()) / Dot11Elt(ID="Rates",info='\x82\x84\x0b\x16') / Dot11Elt(ID="DSset",info="\x08")
    sendp(pkt,iface=sys.argv[2],count=1,inter=0.1,verbose=0)
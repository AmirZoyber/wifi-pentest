
Date : 1402/01/01
Author : AmirhosseinKhanshabani - @AmirZoyber

Packets are divided into layers. Each layer has a specific function.
The layers are divided into two groups: the upper layers and the lower layers.
Each layer has a payload, which is the data that is sent to the next layer and contains all subqueues.
such as RadioTap, Dot11, Dot11Beacon, Dot11Elt, etc.


# Run this script with sudo
# $ scapy


>>> ls()   # List all layers the line below
                                            Dot11 : 802.11

>>> lsc()   # List all possible operattions like: show, send, sr, srp, etc.

>>> conf.iface = "wlan0"   # Set interface
>>> pkts = sniff(count=10)   # Sniff 10 packets
>>> pkts[0]   # Show first packet
<Ether  dst=ff:ff:ff:ff:ff:ff src=00:0c:29:1a:1a:1a type=0x888e |<LLC  dsap=0xaa ssap=0xaa ctrl=0x3 |<SNAP  code=0x0 |<Raw  load='\x00\x00\x00\x00

the " | " character means that the next layer is in the payload of the previous layer AND parse the layers.

>>> ls(Dot11)   # List all layers of Dot11

>>> ls(pkt)   # List all layers of pkt

>>> pkt.payload   # Show payload of pkt

>>> pkt.payload.payload   # Show payload of payload of pkt

>>> pkt.payload.payload.payload   # Show payload of payload of payload of pkt

>>> pkt.payload.payload.payload.underlayer   # Show underlayer of payload of payload of payload of pkt

>>> pkt.payload.payload.payload.info   # Show info of payload of payload of payload of pkt
                                         SSID

>>> pkt.getlayer(Dot11)   # Get Dot11 layer of pkt

>>> pkt.getlayer(Dot11).info   # Get info of Dot11 layer of pkt

>>> pkt.haslayer(Dot11)   # Check if pkt has Dot11 layer
